<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrainerBot • День 1</title>
  <style>
    :root{--bg:#000;--panel:#111;--text:#ffd700;--muted:#cfc08a;--soft:#1a1a1a;--radius:16px;}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,Arial,system-ui,Segoe UI,Roboto,sans-serif;}
    header{position:sticky;top:0;background:linear-gradient(180deg,#0a0a0a,rgba(10,10,10,.9));border-bottom:1px solid #2b2b2b;padding:14px 16px;z-index:10}
    h1{font-size:18px;margin:0;text-transform:uppercase;letter-spacing:.5px}
    main{padding:16px;display:grid;gap:16px}
    .card{background:var(--panel);border:1px solid #2b2b2b;border-radius:var(--radius);overflow:hidden;box-shadow:0 4px 20px rgba(255,215,0,.05)}
    .card-head{display:flex;align-items:center;gap:10px;padding:14px 14px 8px}
    .thumb{width:42px;height:42px;border-radius:10px;background:#0f0f0f;border:1px solid #2b2b2b;display:grid;place-items:center;font-weight:700}
    .title{font-size:16px;font-weight:700}
    .meta{color:var(--muted);font-size:12px}
    .media{position:relative;background:#000}
    .media iframe,.media video{width:100%;aspect-ratio:16/9;border:0}
    .body{padding:14px;display:grid;gap:12px}
    .date{font-size:13px;color:var(--muted)}
    .sets{display:grid;gap:8px}
    .set-row{display:grid;grid-template-columns:28px 1fr 1fr;gap:10px;align-items:center}
    .badge{width:28px;height:28px;border-radius:8px;background:#0c0c0c;border:1px solid #2b2b2b;display:grid;place-items:center;color:#bba24a;font-weight:700}
    .input{display:flex;gap:6px;align-items:center;background:var(--soft);border:1px solid #2b2b2b;border-radius:10px;padding:10px}
    .input input{width:100%;background:transparent;border:0;outline:0;color:var(--text);font-size:15px}
    .suffix{color:#bba24a;font-size:12px;text-transform:uppercase}
    .row-actions{display:flex;gap:8px}
    button{border:0;border-radius:12px;padding:10px 14px;font-weight:700}
    .ghost{background:#0f0f0f;color:#bba24a;border:1px solid #2b2b2b}
    .primary{background:var(--text);color:#000}
    .footer{position:sticky;bottom:0;padding:12px 16px;background:linear-gradient(0deg,#0a0a0a,rgba(10,10,10,.9));border-top:1px solid #2b2b2b;display:flex;gap:10px}
    .note{font-size:12px;color:#a08f49;text-align:center;margin:6px 0 14px}
  </style>
</head>
<body>
  <header>
    <h1>ДЕНЬ 1 — Жим штанги лёжа</h1>
  </header>

  <main>
    <section class="card" data-ex="Жим штанги лёжа">
      <div class="card-head">
        <div class="thumb">ЖШ</div>
        <div>
          <div class="title">Жим штанги лёжа</div>
          <div class="meta">3 подхода • 8–10 повторений</div>
        </div>
      </div>
      <div class="media">
        <!-- Пример: YouTube (можно заменить на любое видео) -->
        <iframe src="https://www.youtube.com/embed/gRVjAtPip0Y" allowfullscreen></iframe>
      </div>
      <div class="body">
        <div class="date" id="dateLabel"></div>
        <div class="sets" id="sets"></div>
        <div class="row-actions">
          <button class="ghost" id="addSet">+ Подход</button>
          <button class="ghost" id="delSet">− Удалить</button>
        </div>
      </div>
    </section>
  </main>

  <div class="note">Совет: держи 1–2 повтора в запасе. Контроль лопаток.</div>

  <div class="footer">
    <button class="ghost" id="clear">Очистить</button>
    <button class="primary" id="save">Сохранить тренировку</button>
  </div>

<script>
  const tg = window.Telegram && window.Telegram.WebApp;
  const today = new Date();
  const months = ["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];
  document.getElementById("dateLabel").textContent =
    `${today.getDate()} ${months[today.getMonth()]}, ${["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"][today.getDay()]}`;

  const setsEl = document.getElementById('sets');
  const addBtn = document.getElementById('addSet');
  const delBtn = document.getElementById('delSet');
  const clearBtn = document.getElementById('clear');
  const saveBtn  = document.getElementById('save');

  function setRow(idx, w='', r=''){
    const row = document.createElement('div');
    row.className = 'set-row';
    row.innerHTML = `
      <div class="badge">${idx}</div>
      <label class="input"><input type="number" inputmode="decimal" step="0.5" placeholder="КГ" value="${w}"><span class="suffix">кг</span></label>
      <label class="input"><input type="number" inputmode="numeric" step="1" placeholder="раз" value="${r}"><span class="suffix">раз</span></label>
    `;
    return row;
  }

  function render(n){
    setsEl.innerHTML='';
    for(let i=1;i<=n;i++) setsEl.appendChild(setRow(i));
  }

  // инициализация
  const KEY='trainerbot_day1_sets';
  const saved = JSON.parse(localStorage.getItem(KEY) || '[]');
  if(saved.length){ // восстановить
    setsEl.innerHTML='';
    saved.forEach((s, i)=> setsEl.appendChild(setRow(i+1, s.weight, s.reps)));
  }else{
    render(3);
  }

  addBtn.onclick = ()=> setsEl.appendChild(setRow(setsEl.children.length+1));
  delBtn.onclick = ()=> { if(setsEl.children.length>1) setsEl.lastElementChild.remove(); };

  clearBtn.onclick = ()=> { localStorage.removeItem(KEY); render(3); };

  saveBtn.onclick = ()=>{
    const exercise = document.querySelector('.card').dataset.ex;
    const out = [];
    [...setsEl.children].forEach((row,i)=>{
      const [wField, rField] = row.querySelectorAll('input');
      const weight = wField.value.trim();
      const reps = rField.value.trim();
      if(weight && reps){
        out.push({exercise, set:i+1, weight, reps});
      }
    });
    localStorage.setItem(KEY, JSON.stringify(out));

    if(tg){
      tg.expand();
      tg.sendData(JSON.stringify(out)); // отправляем в бота
      tg.close();
    }else{
      alert('Сохранил локально:\n'+JSON.stringify(out,null,2));
    }
  }
</script>
</body>
</html>
