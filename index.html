<!DOCTYPE html><html lang="ru"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Full Body ‚Ä¢ 4 –Ω–µ–¥–µ–ª–∏</title>
<style>
:root{--bg:#0b0b0e;--panel:#15161a;--panel2:#121317;--soft:#0e0f12;--border:#2b2f36;--text:#ffd700;--muted:#b9aa68;--white:#f4f4f4;--r:18px}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--white);font-family:Inter,Segoe UI,Roboto,Arial,sans-serif}
header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,#0b0b0e,rgba(11,11,14,.92));border-bottom:1px solid var(--border);padding:12px 16px 6px}
.h1{margin:0;font-size:20px;font-weight:800}.sub{margin-top:6px;color:var(--muted);font-size:12px}
.controls{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
select,.tab{background:var(--panel2);color:var(--white);border:1px solid var(--border);border-radius:12px;padding:8px 12px;font-weight:800}
.tab.active{background:var(--text);color:#000;border-color:var(--text)}
main{padding:14px;display:grid;gap:14px}
.card{background:var(--panel);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;box-shadow:0 10px 26px rgba(0,0,0,.25)}
.head{display:flex;align-items:center;justify-content:space-between;padding:14px 14px 8px}
.left{display:flex;gap:10px;align-items:center}
.thumb{width:44px;height:44px;border-radius:12px;background:var(--soft);border:1px solid var(--border);display:grid;place-items:center}
.title{font-weight:800;font-size:16px}.meta{font-size:12px;color:var(--muted)}.hint{font-size:12px;color:#aeb3bb;margin-top:4px}
.video{background:#000}.video iframe{width:100%;aspect-ratio:16/9;border:0;display:block}
.body{padding:14px;display:grid;gap:12px}.history{font-weight:700;color:#9aa0a6;font-size:13px}.date{font-size:14px;margin-top:8px;margin-bottom:6px;color:#d0d0d0}
.sets{display:grid;gap:10px}
.row{display:grid;grid-template-columns:34px 120px 120px 72px 42px;gap:10px;align-items:center}
@media (max-width:380px){.row{grid-template-columns:30px 105px 105px 66px 36px}}
.badge{height:40px;border-radius:12px;border:1px solid var(--border);background:var(--soft);display:grid;place-items:center;color:var(--text);font-weight:800}
.input{display:flex;gap:6px;align-items:center;background:#101215;border:1px solid var(--border);border-radius:12px;padding:6px}
.input input,.input select{width:100%;background:#1c1c20;border:1px solid #444;border-radius:8px;outline:none;color:#ffd700;font-size:18px;font-weight:700;text-align:center;padding:6px 8px}
.input input::placeholder{color:#b9aa68;opacity:.9}
.input input:focus,.input select:focus{border-color:var(--text);box-shadow:0 0 0 2px rgba(255,215,0,.15)}
.input.rir select{font-size:16px;padding:4px 6px}
.check{width:24px;height:24px;border-radius:8px;border:1px solid var(--border);display:grid;place-items:center;cursor:pointer}
.check input{appearance:none;width:18px;height:18px;border-radius:5px;background:#14161a;border:1px solid #2f3340}
.check input:checked{background:var(--text);border-color:var(--text)}
.actions{display:flex;gap:8px;flex-wrap:wrap}
.btn{border:1px solid var(--border);background:var(--panel2);color:#fff;border-radius:12px;padding:10px 14px;font-weight:800}
.btn.gold{background:var(--text);border-color:var(--text);color:#000}
.bar{position:sticky;bottom:0;z-index:15;background:linear-gradient(0deg,#0b0b0e,rgba(11,11,14,.92));border-top:1px solid var(--border);padding:12px 14px;display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
.note{font-size:12px;color:var(--muted);text-align:center;margin:4px 0 12px}
.sum{font-weight:800;color:#ffd700}.weeksum{font-weight:700;color:#c8b767;font-size:13px}
.tech{background:#0f1014;border-top:1px dashed var(--border);padding:10px 14px;display:none}
.tech p{margin:6px 0 0 0;color:#cfcfcf;font-size:13px;line-height:1.35}.tech b{color:#ffd700}
.techBtn{border:1px dashed var(--border);background:#0f1014;color:#ffd700;border-radius:10px;padding:6px 10px;font-weight:800;font-size:12px}
.techWrap{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
</style>
</head>
<body>
<header>
  <div class="h1">Full Body ‚Äî –≤–µ—Ä—Ö –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ</div>
  <div class="sub">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω ‚Ä¢ 4-–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏—è ‚Ä¢ –±–µ–∑ –æ—Å–µ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫</div>
  <div class="controls">
    <!-- —Ç–∞–±—ã –¥–Ω–µ–π —Å–æ–∑–¥–∞–¥–∏–º –∏–∑ JS –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç user_id -->
    <select id="weekSelect" title="–í—ã–±–µ—Ä–∏ –Ω–µ–¥–µ–ª—é">
      <option value="1">–ù–µ–¥–µ–ª—è 1 ‚Äî –≤—Ç—è–≥–∏–≤–∞—é—â–∞—è</option>
      <option value="2">–ù–µ–¥–µ–ª—è 2 ‚Äî –Ω–∞–≥—Ä—É–∑–æ—á–Ω–∞—è</option>
      <option value="3">–ù–µ–¥–µ–ª—è 3 ‚Äî –ø–∏–∫–æ–≤–∞—è</option>
      <option value="4">–ù–µ–¥–µ–ª—è 4 ‚Äî —Ä–∞–∑–≥—Ä—É–∑–∫–∞</option>
    </select>
  </div>
</header>
<main id="root"></main>
<div class="note">–ù–µ–¥–µ–ª–∏: RIR 1‚Äì2 ‚Üí 0‚Äì1 ‚Üí 0 (–ø–∏–∫) ‚Üí 2‚Äì3 (–¥–µ–ª–æ–∞–¥). –ù–µ–¥.2: +5%/+1; –ù–µ–¥.3: +10%/+1‚Äì2; –ù–µ–¥.4: ‚àí10‚Äì20% –∏ ‚àí1 –ø–æ–¥—Ö–æ–¥.</div>
<div class="bar">
  <div>
    <div class="sum" id="summary">–¢–æ–Ω–Ω–∞–∂: 0 –∫–≥ ‚Ä¢ –°–µ—Ç—ã (–≤—ã–ø.): 0</div>
    <div class="weeksum" id="weekSummary">–ò—Ç–æ–≥–æ –∑–∞ –Ω–µ–¥–µ–ª—é: 0 –∫–≥ ‚Ä¢ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–µ—Ç–æ–≤: 0</div>
  </div>
  <div>
    <button class="btn" id="clearBtn">–û—á–∏—Å—Ç–∏—Ç—å –¥–µ–Ω—å</button>
    <button class="btn gold" id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
/* ===== –û–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω –¥–ª—è –≤–∏–¥–µ–æ ===== */
const IS_ONLINE = typeof navigator !== 'undefined' ? navigator.onLine : false;
function rutubeFrame(id){
  if(!id) return "";
  if(!IS_ONLINE) return '<div class="video" style="display:flex;align-items:center;justify-content:center;aspect-ratio:16/9;border-top:1px solid #222;border-bottom:1px solid #222"><div style="color:#ffd700;font-weight:800">–í–∏–¥–µ–æ –¥–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ</div></div>';
  return `<div class="video"><iframe src="https://rutube.ru/play/embed/${id}" allowfullscreen></iframe></div>`;
}

/* ===== Telegram user ===== */
const TG = window.Telegram?.WebApp || null;
const TG_USER = TG?.initDataUnsafe?.user || null;
const UID = TG_USER?.id || null;
if (TG) TG.expand();

/* ===== –¢–ï–•–ù–ò–ö–ê ===== */
const TECH = {
  "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞":[ "–õ–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã, –≥—Ä—É–¥—å –≤–≤–µ—Ä—Ö.", "–•–≤–∞—Ç —á—É—Ç—å —à–∏—Ä–µ –ø–ª–µ—á; –∫–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑ –æ—Ç—Å–∫–æ–∫–∞.", "–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è ‚Äî –¥—É–≥–∞ –∫ –Ω–∏–∂–Ω–µ–º—É –∫—Ä–∞—é –≥—Ä—É–¥–∏." ],
  "–¢—è–≥–∞ –±–ª–æ–∫–∞ –∫ –ø–æ—è—Å—É":[ "–°–ø–∏–Ω–∞ —Ä–æ–≤–Ω–∞—è, –ª—ë–≥–∫–∏–π –Ω–∞–∫–ª–æ–Ω.", "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –∫ —Ç–∞–∑—É; –ø–∞—É–∑–∞ –≤ –ø–∏–∫-—Å–æ–∫—Ä–∞—â–µ–Ω–∏–∏." ],
  "–ñ–∏–º –Ω–æ–≥–∞–º–∏":[ "–ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞; –≥–ª—É–±–∏–Ω–∞ 90‚Äì110¬∞; –∫–æ–ª–µ–Ω–∏ –Ω–µ –≤ –∑–∞–º–æ–∫." ],
  "–ü–æ–¥—ä—ë–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å":[ "–õ–æ–∫—Ç–∏ —É –∫–æ—Ä–ø—É—Å–∞; –±–µ–∑ —Ä–∞—Å–∫–∞—á–∫–∏; —Ç–µ–º–ø 2‚Äì0‚Äì1." ],
  "–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –¥–ª—è –ø–ª–µ—á":[ "–°–ø–∏–Ω–∞ –∏ —Ç–∞–∑ –ø—Ä–∏–∂–∞—Ç—ã; –∞–º–ø–ª–∏—Ç—É–¥–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è." ],
  "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –≤ –±–ª–æ–∫–µ (–∫–∞–Ω–∞—Ç)":[ "–õ–æ–∫—Ç–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã; –≤–Ω–∏–∑—É —Ä–∞–∑–≤–µ–¥–∏ –∫–∞–Ω–∞—Ç—ã –∏ –ø–∞—É–∑–∞." ],
  "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π 45¬∞":[ "–õ–æ–ø–∞—Ç–∫–∏ —Å–≤–µ–¥–µ–Ω—ã; –∂–º–∏ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –≤–≤–µ—Ä—Ö; –Ω–µ –∑–∞–ø–∏—Ä–∞–π –ª–æ–∫—Ç–∏." ],
  "–¢—è–≥–∞ –±–ª–æ–∫–∞ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º":[ "–õ–æ–∫—Ç–∏ –≤–¥–æ–ª—å –∫–æ—Ä–ø—É—Å–∞; —Å–≤–æ–¥–∏ –ª–æ–ø–∞—Ç–∫–∏ –≤ –∫–æ–Ω—Ü–µ." ],
  "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ":[ "–û—Å—å –∫–æ–ª–µ–Ω–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç; –ø–∞—É–∑–∞ –≤–≤–µ—Ä—Ö—É; –≤–Ω–∏–∑ ‚Äî –ø–æ–¥–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ." ],
  "–°–≥–∏–±–∞–Ω–∏—è —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ (–±–∏—Ü–µ–ø—Å)":[ "–ü–ª–µ—á–∏ –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã; —Ç–æ–ª—å–∫–æ –ª–æ–∫–æ—Ç—å; –±–µ–∑ —Ä–∞—Å–∫–∞—á–∫–∏." ],
  "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã":[ "–ú—è–≥–∫–∏–π —Å–≥–∏–± –ª–æ–∫—Ç—è; –Ω–µ –≤—ã—à–µ —É—Ä–æ–≤–Ω—è –ø–ª–µ—á; –∫–æ–Ω—Ç—Ä–æ–ª—å." ],
  "–û—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö":[ "–ö–æ—Ä–ø—É—Å –≤–ø–µ—Ä—ë–¥ (–≥—Ä—É–¥—å) –∏–ª–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å (—Ç—Ä–∏—Ü–µ–ø—Å); –≥–ª—É–±–∏–Ω–∞ –±–µ–∑ –±–æ–ª–∏." ],
  "–û—Ç–∂–∏–º–∞–Ω–∏—è —Å –Ω–æ–≥–∞–º–∏ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–∏–∏":[ "–ö–æ—Ä–ø—É—Å –æ–¥–Ω–æ–π –ª–∏–Ω–∏–µ–π; –∫–∞—Å–∞–Ω–∏–µ –≥—Ä—É–¥—å—é; –±–µ–∑ –ø—Ä–æ–≤–∏—Å–∞ –ø–æ—è—Å–Ω–∏—Ü—ã." ],
  "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞":[ "–õ–æ–∫—Ç–∏ ~45¬∞; –ø–∞—É–∑–∞ –≤–Ω–∏–∑—É; –±–µ–∑ –æ—Ç—Å–∫–æ–∫–∞." ],
  "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ":[ "–ù–∞–∫–ª–æ–Ω –∏–∑ —Ç–∞–∑–∞; —Ç—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏; –ø–∞—É–∑–∞ –≤–≤–µ—Ä—Ö—É." ],
  "–£–∑–∫–∏–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è":[ "–õ–æ–∫—Ç–∏ –±–ª–∏–∑–∫–æ –∫ –∫–æ—Ä–ø—É—Å—É; –∫–æ—Ä–ø—É—Å ‚Äî –ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è." ],
  "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ –Ω–∞–∫–ª–æ–Ω–µ":[ "–ì—Ä—É–¥—å –∫ –±–µ–¥—Ä–∞–º; —Å–≤–æ–¥ –ª–æ–ø–∞—Ç–æ–∫; –±–µ–∑ —Ä—ã–≤–∫–æ–≤." ],
  "–ü–ª–∞–Ω–∫–∞":[ "–¢–∞–∑ –Ω–µ–π—Ç—Ä–∞–ª–µ–Ω; –ø—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω; –¥—ã—Ö–∞–Ω–∏–µ —Ä–æ–≤–Ω–æ–µ." ],
  "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏":[ "–ì—Ä—É–¥—å –≤–≤–µ—Ä—Ö; –∫–æ–ª–µ–Ω–∏ –≤ –Ω–æ—Å–∫–∏; —Å—Ç–æ–ø—ã —Ä–æ–≤–Ω–æ." ],
  "–í—ã–ø–∞–¥—ã –Ω–∞–∑–∞–¥":[ "–®–∞–≥ –Ω–∞–∑–∞–¥; –∫–æ–ª–µ–Ω–æ –ø–æ–¥ —Ç–∞–∑–æ–º; –∫–æ—Ä–ø—É—Å –≤–µ—Ä—Ç–∏–∫–∞–ª–µ–Ω." ],
  "–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫":[ "–ü–æ–¥–±–æ—Ä–æ–¥–æ–∫ –∫ –≥—Ä—É–¥–∏; –ø–∞—É–∑–∞ –Ω–∞–≤–µ—Ä—Ö—É; –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –ø–æ—è—Å–Ω–∏—Ü–∞." ],
  "–ú–∞—Ö–∏ –Ω–æ–≥–∞–º–∏ —Å —Ä–µ–∑–∏–Ω–∫–æ–π":[ "–ö–æ—Ä–ø—É—Å —Å—Ç–∞–±–∏–ª–µ–Ω; —Ä–∞–±–æ—Ç–∞ –∏–∑ —Ç–∞–∑–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ." ],
  "Goblet squat":[ "–ì–∞–Ω—Ç–µ–ª—å —É –≥—Ä—É–¥–∏; –∫–æ–ª–µ–Ω–∏ –≤ –Ω–æ—Å–∫–∏; –ø—è—Ç–∫–∞ –ø—Ä–∏–∂–∞—Ç–∞." ],
  "–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞":[ "–î–≤–∏–∂–µ–Ω–∏–µ –∏–∑ –±–µ–¥—Ä–∞; —Å–ø–∏–Ω–∞ —Ä–æ–≤–Ω–∞—è; —à—Ç–∞–Ω–≥–∞ –±–ª–∏–∑–∫–æ –∫ –Ω–æ–≥–∞–º." ],
  "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –≤–≤–µ—Ä—Ö":[ "–õ–æ–ø–∞—Ç–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ; –Ω–µ –∑–∞–ø–∏—Ä–∞–π –ª–æ–∫—Ç–∏." ],
  "–í–µ–ª–æ—Å–∏–ø–µ–¥ (–ø—Ä–µ—Å—Å)":[ "–ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞; –∫—Ä—É—Ç–∏ –ø–æ–¥–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ." ],
  "–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –±–µ–≥":[ "–†–∞–∑–º–∏–Ω–∫–∞ 5‚Äì10 –º–∏–Ω; –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã 30/90 —Å–µ–∫; –æ—Ç–¥—ã—à–∞—Ç—å—Å—è –º–µ–∂–¥—É." ],
  "–ê–ª—å–ø–∏–Ω–∏—Å—Ç":[ "–ö–æ—Ä–ø—É—Å —Å—Ç–∞–±–∏–ª–µ–Ω; –∫–æ–ª–µ–Ω–æ –∫ –≥—Ä—É–¥–∏; —Ç–µ–º–ø –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π." ],
  "–û–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å–∫–∞–º—å–∏":[ "–õ–æ–∫—Ç–∏ –Ω–∞–∑–∞–¥; –ø–ª–µ—á–æ –Ω–µ –∑–∞–∂–∏–º–∞–π; –∞–º–ø–ª–∏—Ç—É–¥–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∞." ],
  "–í—ã–ø—Ä—ã–≥–∏–≤–∞–Ω–∏—è –∏–∑ –ø—Ä–∏—Å–µ–¥–∞":[ "–ú—è–≥–∫–∞—è –ø–æ—Å–∞–¥–∫–∞; –∫–æ–ª–µ–Ω–∏ –≤ –æ—Å–∏; –∫–æ—Ä–ø—É—Å —Å–æ–±—Ä–∞–Ω." ]
};

/* ===== –ü–õ–ê–ù–´ ===== */
// –¢–≤–æ–π 3-–¥–Ω–µ–≤–Ω—ã–π (–∑–∞–ª-–∑–∞–ª-–¥–æ–º, —Å RuTube ID)
const PLAN_OWNER = {
  tabs:["–î–µ–Ω—å 1","–î–µ–Ω—å 2","–î–µ–Ω—å 3"],
  plan:{
    1:[
      {t:"–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞", base:"4√ó8‚Äì10", sets:4, id:"29048ced12e2808a6097447cf00821fd"},
      {t:"–¢—è–≥–∞ –±–ª–æ–∫–∞ –∫ –ø–æ—è—Å—É", base:"4√ó8‚Äì10", sets:4, id:"e5f800727b6688c3ec31f62e48303cb0"},
      {t:"–ñ–∏–º –Ω–æ–≥–∞–º–∏", base:"4√ó8‚Äì10", sets:4, id:"6eb13cced1079f3c1c167ec187c0b324"},
      {t:"–ü–æ–¥—ä—ë–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å", base:"3√ó12‚Äì16", sets:3, id:"9e19a98a96bf0fa3ed85b3d0b3e02a9d"},
      {t:"–ñ–∏–º –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –¥–ª—è –ø–ª–µ—á", base:"3√ó12‚Äì16", sets:3, id:"dd55b827ba26093c43756fc93e0a0468"},
      {t:"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ç—Ä–∏—Ü–µ–ø—Å–∞ –≤ –±–ª–æ–∫–µ (–∫–∞–Ω–∞—Ç)", base:"3√ó12‚Äì16", sets:3, id:"c3b414b47e814f390ffda4cd02019b4d"}
    ],
    2:[
      {t:"–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π 45¬∞", base:"4√ó8‚Äì10", sets:4, id:"e585b41ea1a271381fb635e813257048"},
      {t:"–¢—è–≥–∞ –±–ª–æ–∫–∞ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º", base:"4√ó8‚Äì10", sets:4, id:"b705869d4680dfa63bfff8831610d191"},
      {t:"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ", base:"4√ó8‚Äì10", sets:4, id:"f9add4e54a65649c36dc96b40e31091e"},
      {t:"–°–≥–∏–±–∞–Ω–∏—è —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ (–±–∏—Ü–µ–ø—Å)", base:"3√ó12‚Äì16", sets:3, id:"87549fc5f5de396c2b769f8990778ede"},
      {t:"–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã", base:"3√ó12‚Äì16", sets:3, id:"6128640e54d2e669a0279310980d65cc"},
      {t:"–û—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö", base:"3√ó12‚Äì16", sets:3, id:"b8fac352889a4bd4c083d87dd4a1be10"}
    ],
    3:[
      {t:"–û—Ç–∂–∏–º–∞–Ω–∏—è —Å –Ω–æ–≥–∞–º–∏ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–∏–∏", base:"4√ó–º–∞–∫—Å", sets:4, id:"8c3c63d02b943d3851527d03c5f0d70d"},
      {t:"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", base:"3√ó8‚Äì12", sets:3, id:"8727ed482623ae3a9fce393d5456de68"},
      {t:"–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ", base:"3√ó8‚Äì12", sets:3, id:"1816f401fa38ac77e8c912125728af74"},
      {t:"–£–∑–∫–∏–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è", base:"3√ó–º–∞–∫—Å", sets:3, id:"b968f2c89084c3d90b9add1da01cf39d"},
      {t:"–ü–æ–¥—ä—ë–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –±–∏—Ü–µ–ø—Å", base:"3√ó12", sets:3, id:"2b0ae567aa5d0a00633594f26fe8bf2e"},
      {t:"–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ –Ω–∞–∫–ª–æ–Ω–µ", base:"3√ó12‚Äì15", sets:3, id:"5bf13c73ef01f3a4629f00982b83788d"},
      {t:"–ü–ª–∞–Ω–∫–∞", base:"3√ó40‚Äì60 —Å–µ–∫", sets:3, id:"6df677885d3361d1271228208387c6bd"}
    ]
  }
};

// Mashka (ID 603111062) ‚Äî 4-–¥–Ω–µ–≤–Ω—ã–π –¥–æ–º–∞—à–Ω–∏–π –ø–ª–∞–Ω
const PLAN_MASHKA = {
  tabs:["–ü–Ω ‚Äî A","–°—Ä ‚Äî B","–ü—Ç ‚Äî C","–í—Å ‚Äî D"],
  plan:{
    1:[
      {t:"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", base:"4√ó12‚Äì15", sets:4},
      {t:"–í—ã–ø–∞–¥—ã –Ω–∞–∑–∞–¥", base:"3√ó12/–Ω–æ–≥–∞", sets:3},
      {t:"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫", base:"4√ó15‚Äì20", sets:4},
      {t:"–ú–∞—Ö–∏ –Ω–æ–≥–∞–º–∏ —Å —Ä–µ–∑–∏–Ω–∫–æ–π", base:"3√ó15‚Äì20", sets:3},
      {t:"–ü–ª–∞–Ω–∫–∞", base:"3√ó30‚Äì60 —Å–µ–∫", sets:3},
      {t:"–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", base:"3√ó15‚Äì20", sets:3}
    ],
    2:[
      {t:"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", base:"4√ó12‚Äì15", sets:4},
      {t:"–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ", base:"4√ó12", sets:4},
      {t:"–û—Ç–∂–∏–º–∞–Ω–∏—è", base:"3√ó–º–∞–∫—Å", sets:3},
      {t:"–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã", base:"3√ó12‚Äì15", sets:3},
      {t:"–°–≥–∏–±–∞–Ω–∏—è —Ä—É–∫ (–±–∏—Ü–µ–ø—Å)", base:"3√ó12‚Äì15", sets:3},
      {t:"–ö–∞—Ä–¥–∏–æ-–±–ª–æ–∫ (–ø—Ä—ã–∂–∫–∏)", base:"3√ó30 —Å–µ–∫", sets:3}
    ],
    3:[
      {t:"Goblet squat", base:"4√ó12‚Äì15", sets:4},
      {t:"–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞", base:"4√ó12‚Äì15", sets:4},
      {t:"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫ —Å –ø–∞—É–∑–æ–π", base:"4√ó15‚Äì20", sets:4},
      {t:"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –≤–≤–µ—Ä—Ö", base:"3√ó12‚Äì15", sets:3},
      {t:"–û–±—Ä–∞—Ç–Ω—ã–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤ –Ω–∞–∫–ª–æ–Ω–µ", base:"3√ó12‚Äì15", sets:3},
      {t:"–í–µ–ª–æ—Å–∏–ø–µ–¥ (–ø—Ä–µ—Å—Å)", base:"3√ó20/—Å—Ç–æ—Ä–æ–Ω—É", sets:3}
    ],
    4:[
      {t:"–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –±–µ–≥", base:"30/90 —Å–µ–∫ √ó6‚Äì8", sets:6},
      {t:"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è", base:"3√ó20", sets:3},
      {t:"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å–∫–∞–º—å–∏/–∑–µ–º–ª–∏", base:"3√ó–º–∞–∫—Å", sets:3},
      {t:"–í—ã–ø—Ä—ã–≥–∏–≤–∞–Ω–∏—è –∏–∑ –ø—Ä–∏—Å–µ–¥–∞", base:"3√ó10‚Äì12", sets:3},
      {t:"–ê–ª—å–ø–∏–Ω–∏—Å—Ç", base:"3√ó20‚Äì30 —Å–µ–∫", sets:3},
      {t:"–û–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å–∫–∞–º—å–∏", base:"3√ó12‚Äì15", sets:3},
      {t:"–ü—Ä–µ—Å—Å (–Ω–æ–∂–Ω–∏—Ü—ã/–ø–æ–¥—ä—ë–º –Ω–æ–≥)", base:"3√ó15‚Äì20", sets:3}
    ]
  }
};

// –í—ã–±–æ—Ä –ø–ª–∞–Ω–∞ –ø–æ user_id
const PLAN = (UID === 603111062) ? PLAN_MASHKA : PLAN_OWNER;

// –ü–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏—è
const WEEKS = {
  1:{ add:0,  note:"RIR 1‚Äì2" },
  2:{ add:0,  note:"+5% –∏/–∏–ª–∏ +1, RIR 0‚Äì1" },
  3:{ add:0,  note:"+10% –∏/–∏–ª–∏ +1‚Äì2, RIR 0" },
  4:{ add:-1, note:"–î–µ–ª–æ–∞–¥ ‚àí10‚Äì20%, ‚àí1 –ø–æ–¥—Ö–æ–¥, RIR 2‚Äì3" }
};

/* ===== UI / –õ–û–ì–ò–ö–ê ===== */
const headerControls = document.querySelector('.controls');
const weekSelect = document.getElementById('weekSelect');
const root = document.getElementById('root');
const summary = document.getElementById('summary');
const weekSummary = document.getElementById('weekSummary');

let day = 1;

// –°–æ–∑–¥–∞—ë–º —Ç–∞–±—ã ¬´–î–Ω–∏¬ª –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø–ª–∞–Ω–µ
function buildTabs(){
  // —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ
  headerControls.querySelectorAll('button.tab').forEach(b=>b.remove());
  PLAN.tabs.forEach((label,i)=>{
    const b = document.createElement('button');
    b.className = 'tab' + (i===0?' active':'');
    b.dataset.day = String(i+1);
    b.textContent = label;
    b.onclick = ()=>{ document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); b.classList.add('active'); day=i+1; render(); };
    headerControls.insertBefore(b, weekSelect);
  });
}
buildTabs();

function today(){
  const d=new Date(),w=["–í—Å–∫","–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±"][d.getDay()],m=["—è–Ω–≤","—Ñ–µ–≤","–º–∞—Ä","–∞–ø—Ä","–º–∞–π","–∏—é–Ω","–∏—é–ª","–∞–≤–≥","—Å–µ–Ω","–æ–∫—Ç","–Ω–æ—è","–¥–µ–∫"][d.getMonth()];
  return `${d.getDate()} ${m}, ${w}`;
}
function keyName(ex){ return `fb_${day}_${weekSelect.value}_${ex.replace(/\s+/g,'_')}_${UID||'anon'}`; }
function parseNum(v){ const n=parseFloat((v||"").toString().replace(",", ".")); return isNaN(n)?0:n; }

function setRow(i,w='',r='',rir='',done=0){
  const el=document.createElement('div'); el.className='row'; el.innerHTML=`
    <div class="badge">${i}</div>
    <div class="input"><input type="number" step="0.5" inputmode="decimal" placeholder="–ö–ì" value="${w}"></div>
    <div class="input"><input type="number" step="1" inputmode="numeric" placeholder="—Ä–∞–∑" value="${r}"></div>
    <div class="input rir"><select aria-label="RIR">
      <option value="" ${rir===''?'selected':''}>RIR</option>
      <option value="0" ${rir==='0'?'selected':''}>0</option>
      <option value="1" ${rir==='1'?'selected':''}>1</option>
      <option value="2" ${rir==='2'?'selected':''}>2</option>
      <option value="3" ${rir==='3'?'selected':''}>3</option>
    </select></div>
    <label class="check" title="—Å–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω"><input type="checkbox" ${done? 'checked':''}></label>`;
  el.querySelectorAll('input,select').forEach(i=>i.addEventListener('input',updateSummary));
  return el;
}

function techBlock(name){
  const wrap=document.createElement('div'); wrap.className='techWrap';
  const btn=document.createElement('button'); btn.className='techBtn'; btn.type='button'; btn.textContent='–¢–µ—Ö–Ω–∏–∫–∞';
  const box=document.createElement('div'); box.className='tech';
  const tips=(TECH[name]||["–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏–∫–∏."]).map(t=>`<p>‚Ä¢ ${t}</p>`).join("");
  box.innerHTML=`<p><b>–ö–∞–∫ –¥–µ–ª–∞—Ç—å:</b></p>${tips}`;
  btn.onclick=()=>{ box.style.display = (box.style.display==='block'?'none':'block'); };
  wrap.appendChild(btn); wrap.appendChild(box);
  return wrap;
}

function card(ex){
  const saved = JSON.parse(localStorage.getItem(keyName(ex.t))||'[]');
  const add = WEEKS[weekSelect.value].add||0;
  const baseSets = Math.max(1, (ex.sets||3) + add);
  const last = JSON.parse(localStorage.getItem(keyName(ex.t)+'_last')||'[]');

  const wrap=document.createElement('section'); wrap.className='card'; wrap.dataset.exercise=ex.t;
  wrap.innerHTML=`
    <div class="head">
      <div class="left">
        <div class="thumb">üèãÔ∏è</div>
        <div>
          <div class="title">${ex.t}</div>
          <div class="meta">${ex.base||''} ${WEEKS[weekSelect.value].note? '‚Ä¢ '+WEEKS[weekSelect.value].note:''}</div>
          <div class="hint">${ last.length ? '–ü—Ä–æ—à–ª—ã–π —Ä–∞–∑: ' + last.map(s=>`${s.weight||0}√ó${s.reps||0}${s.rir!==''?` (RIR ${s.rir})`:''}`).join(', ') : '–ó–∞–ø–æ–ª–Ω–∏ –∏ –Ω–∞–∂–º–∏ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å¬ª'}</div>
        </div>
      </div>
      <div class="avatar">üë§</div>
    </div>
    ${rutubeFrame(ex.id)}
    <div class="body">
      <div class="history">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π:</div>
      <div class="date">${today()}</div>
      <div class="sets"></div>
      <div class="actions">
        <button class="btn add" type="button">+ –ü–æ–¥—Ö–æ–¥</button>
        <button class="btn del" type="button">‚àí –£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>`;
  wrap.querySelector('.body').insertBefore(techBlock(ex.t), wrap.querySelector('.actions'));
  const box=wrap.querySelector('.sets');
  const count = saved.length? saved.length : baseSets;
  for(let i=1;i<=count;i++){
    const s=saved[i-1]||{};
    box.appendChild(setRow(i,s.weight||'',s.reps||'', (s.rir??'').toString(), s.done?1:0));
  }
  wrap.querySelector('.add').onclick=()=>{ box.appendChild(setRow(box.children.length+1)); updateSummary(); };
  wrap.querySelector('.del').onclick=()=>{ if(box.children.length>1){ box.lastElementChild.remove(); updateSummary(); } };
  return wrap;
}

function render(){
  root.innerHTML='';
  (PLAN.plan[day]||[]).forEach(ex=> root.appendChild(card(ex)));
  updateSummary();
}

function updateSummary(){
  let tonnage=0, setsDone=0;
  root.querySelectorAll('.card').forEach(card=>{
    card.querySelectorAll('.row').forEach(r=>{
      const [w,rp]=r.querySelectorAll('input');
      const weight=parseNum(w.value), reps=parseInt(rp.value||0,10);
      const done = r.querySelector('input[type="checkbox"]').checked;
      if(weight>0 && reps>0){
        tonnage += weight*reps;
        if(done) setsDone++;
      }
    });
  });
  summary.textContent = `–¢–æ–Ω–Ω–∞–∂: ${Math.round(tonnage)} –∫–≥ ‚Ä¢ –°–µ—Ç—ã (–≤—ã–ø.): ${setsDone}`;

  let weekTonn=0, weekSets=0;
  Object.keys(localStorage).forEach(k=>{
    const m=k.match(/^fb_(\d+)_(\d+)_(.+)_(\d+|anon)$/);
    if(!m) return;
    const wk = m[2], uid = m[4];
    if(wk !== weekSelect.value) return;
    if((UID||'anon').toString() !== uid) return;
    const arr = JSON.parse(localStorage.getItem(k)||'[]');
    arr.forEach(s=>{
      const w=parseNum(s.weight), r=parseInt(s.reps||0,10);
      if(w>0 && r>0){ weekTonn += w*r; if(s.done) weekSets++; }
    });
  });
  weekSummary.textContent = `–ò—Ç–æ–≥–æ –∑–∞ –Ω–µ–¥–µ–ª—é: ${Math.round(weekTonn)} –∫–≥ ‚Ä¢ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–µ—Ç–æ–≤: ${weekSets}`;
}

/* –∫–Ω–æ–ø–∫–∏ */
document.getElementById('clearBtn').onclick=()=>{ if(confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è?')) render(); };
document.getElementById('saveBtn').onclick=()=>{
  const payload=[];
  root.querySelectorAll('.card').forEach(card=>{
    const name=card.dataset.exercise, list=[];
    card.querySelectorAll('.row').forEach((r,i)=>{
      const inputs=r.querySelectorAll('input');
      const w=inputs[0], rp=inputs[1], cb=inputs[2];
      const sel=r.querySelector('select');
      const weight=(w.value||'').trim(), reps=(rp.value||'').trim(), rir=(sel.value??'').toString(), done=cb.checked?1:0;
      if(weight || reps){
        const item={set:i+1, weight, reps, rir, done};
        list.push(item);
        payload.push({user_id:UID||null, day, week:+weekSelect.value, exercise:name, ...item, ts:new Date().toISOString()});
      }
    });
    localStorage.setItem(keyName(name), JSON.stringify(list));
    if(list.length) localStorage.setItem(keyName(name)+'_last', JSON.stringify(list));
  });

  if(TG){ TG.sendData(JSON.stringify(payload)); TG.close(); }
  else { alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ:\n'+JSON.stringify(payload,null,2)); }
};

document.querySelectorAll('.tab').forEach(b=>b.onclick=()=>{document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));b.classList.add('active');day=+b.dataset.day;render();});
weekSelect.onchange = render;

/* —Å—Ç–∞—Ä—Ç */
render();
</script>
</body></html>